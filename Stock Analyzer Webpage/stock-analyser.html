<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Stock Analysis Platform with Live Market & Momentum Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            color: #333;
        }

        /* Live Market Section */
        .live-market-container {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            padding: 25px;
            border-bottom: 4px solid #0f3460;
        }

        .market-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .live-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            background: #00ff00;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .market-indices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .index-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .index-name {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .index-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .index-change {
            font-size: 14px;
            font-weight: bold;
        }

        .positive { color: #00ff88; }
        .negative { color: #ff4444; }

        /* Momentum Scanner Section */
        .momentum-section {
            background: white;
            margin: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .momentum-header {
            background: linear-gradient(135deg, #2c5aa0, #1e4178);
            color: white;
            padding: 25px;
            text-align: center;
        }

        .strategy-indicator {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
            font-size: 14px;
        }

        .momentum-stocks {
            padding: 30px;
        }

        .stock-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stock-card {
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            background: white;
        }

        .stock-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border-color: #2c5aa0;
        }

        .stock-card.buy-signal {
            border-color: #28a745;
            background: linear-gradient(145deg, #ffffff, #f8fff9);
        }

        .stock-card.strong-momentum {
            border-color: #007bff;
            background: linear-gradient(145deg, #ffffff, #f8faff);
        }

        .signal-badge {
            position: absolute;
            top: -10px;
            right: 15px;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }

        .buy-badge { background: #28a745; }
        .momentum-badge { background: #007bff; }

        .stock-symbol {
            font-size: 18px;
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 5px;
        }

        .stock-name {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }

        .stock-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .metric {
            text-align: center;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .metric-label {
            font-size: 11px;
            color: #666;
            margin-bottom: 3px;
        }

        .metric-value {
            font-size: 14px;
            font-weight: bold;
        }

        .metric-value.bullish { color: #28a745; }
        .metric-value.neutral { color: #ffc107; }
        .metric-value.bearish { color: #dc3545; }

        .strategy-details {
            margin-top: 15px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #2c5aa0;
        }

        .strategy-details h4 {
            font-size: 12px;
            color: #2c5aa0;
            margin-bottom: 8px;
        }

        .conditions-met {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .condition-tag {
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 12px;
            background: #e3f2fd;
            color: #1976d2;
        }

        .condition-tag.met {
            background: #e8f5e8;
            color: #2e7d32;
        }

        /* Search Container Enhancement */
        .search-container {
            background: linear-gradient(135deg, #2c5aa0, #1e4178);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .search-box {
            max-width: 600px;
            margin: 20px auto;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            outline: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .search-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Loading and Report styles (previous styles) */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2c5aa0;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .report-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            display: none;
        }

        .section {
            padding: 30px;
            border-bottom: 2px solid #e9ecef;
        }

        .section h2 {
            color: #2c5aa0;
            border-bottom: 3px solid #2c5aa0;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        /* Data Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .data-table th {
            background: #2c5aa0;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #dee2e6;
        }

        .data-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .data-table tr:hover {
            background-color: #e3f2fd;
        }

        .trend-up { color: #28a745; font-weight: bold; }
        .trend-down { color: #dc3545; font-weight: bold; }
        .trend-stable { color: #fd7e14; font-weight: bold; }
    </style>
</head>
<body>
    <!-- Live Market Section -->
    <div class="live-market-container">
        <div class="market-header">
            <h2><span class="live-indicator"></span>Live Market Dashboard</h2>
            <p style="opacity: 0.8;">Real-time Indian Stock Market Overview | Updated: <span id="marketTime">Loading...</span></p>
        </div>
        
        <div class="market-indices">
            <div class="index-card">
                <div class="index-name">NIFTY 50</div>
                <div class="index-value" id="nifty50">24,823.15</div>
                <div class="index-change positive" id="nifty50Change">+127.70 (+0.52%)</div>
            </div>
            <div class="index-card">
                <div class="index-name">SENSEX</div>
                <div class="index-value" id="sensex">81,086.21</div>
                <div class="index-change positive" id="sensexChange">+384.30 (+0.48%)</div>
            </div>
            <div class="index-card">
                <div class="index-name">NIFTY MIDCAP 150</div>
                <div class="index-value" id="midcap150">18,439.85</div>
                <div class="index-change positive" id="midcap150Change">+98.25 (+0.54%)</div>
            </div>
            <div class="index-card">
                <div class="index-name">NIFTY SMALLCAP 250</div>
                <div class="index-value" id="smallcap250">17,284.90</div>
                <div class="index-change positive" id="smallcap250Change">+156.40 (+0.91%)</div>
            </div>
            <div class="index-card">
                <div class="index-name">VIX</div>
                <div class="index-value" id="vix">13.42</div>
                <div class="index-change negative" id="vixChange">-0.28 (-2.04%)</div>
            </div>
            <div class="index-card">
                <div class="index-name">USD/INR</div>
                <div class="index-value" id="usdinr">83.73</div>
                <div class="index-change negative" id="usdinrChange">-0.12 (-0.14%)</div>
            </div>
        </div>
    </div>

    <!-- Momentum Scanner Section -->
    <div class="momentum-section">
        <div class="momentum-header">
            <h2>🚀 MIDCAP MOMENTUM MASTER v6 - Top Swing Trading Picks</h2>
            <p>AI-Powered momentum scanner based on your Pine Script strategy</p>
            <div class="strategy-indicator">
                <strong>Strategy Active:</strong> EMA Trend + RSI Momentum + Volume Surge + Bollinger Breakout
            </div>
        </div>
        
        <div class="momentum-stocks">
            <h3>Top 5 Momentum Stocks Meeting Strategy Criteria</h3>
            <p style="margin-bottom: 20px; color: #666;">Filtered by: Price 50-10000 | Volume >500K | EMA Uptrend | RSI 40-80 | Volume Surge 1.5x</p>
            
            <div class="stock-grid" id="momentumStocks">
                <!-- Dynamic momentum stocks will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Original Search Interface -->
    <div class="search-container">
        <h1>🔍 Professional Stock Analysis Dashboard</h1>
        <p style="margin: 10px 0; opacity: 0.9;">Search for any Indian stock to generate comprehensive equity research reports</p>
        
        <div class="search-box">
            <input type="text" class="search-input" id="stockSearch" placeholder="Enter stock name (e.g., Reliance, TCS, HDFC Bank)" autocomplete="off">
            <button class="search-btn" onclick="searchStock()">Analyze</button>
        </div>
    </div>

    <!-- Loading Animation -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p style="margin-top: 20px; color: #666;">Analyzing stock data and generating report...</p>
    </div>

    <!-- Report Container -->
    <div class="report-container" id="reportContainer">
        <!-- Dynamic content will be inserted here -->
    </div>

    <script>
        // Enhanced Stock Database with Pine Script Strategy Metrics
        const momentumStockDatabase = {
            'reliance': {
                name: 'Reliance Industries Ltd',
                symbol: 'RELIANCE',
                price: 1368,
                marketCap: 1850971,
                volume: 2850000,
                avgVolume: 1900000,
                ema20: 1342,
                ema50: 1298,
                ema200: 1245,
                rsi: 58.4,
                macdBullish: true,
                bbPosition: 'upper',
                atr: 45.2,
                momentum: 'moderate',
                signal: 'HOLD'
            },
            'man infraconstruction': {
                name: 'Man Infraconstruction Ltd',
                symbol: 'MANINFRA',
                price: 166,
                marketCap: 6396,
                volume: 892000,
                avgVolume: 580000,
                ema20: 158,
                ema50: 145,
                ema200: 132,
                rsi: 67.2,
                macdBullish: true,
                bbPosition: 'upper',
                atr: 8.4,
                momentum: 'strong',
                signal: 'BUY'
            },
            'shilchar tech': {
                name: 'Shilchar Technologies Ltd',
                symbol: 'SHILCHAR',
                price: 5170.60,
                marketCap: 5915,
                volume: 125000,
                avgVolume: 75000,
                ema20: 4980,
                ema50: 4650,
                ema200: 4200,
                rsi: 71.3,
                macdBullish: true,
                bbPosition: 'upper',
                atr: 285,
                momentum: 'very_strong',
                signal: 'STRONG_BUY'
            },
            'websol energy': {
                name: 'Websol Energy System Ltd',
                symbol: 'WEBSOL',
                price: 1316.70,
                marketCap: 5716,
                volume: 245000,
                avgVolume: 145000,
                ema20: 1240,
                ema50: 1150,
                ema200: 980,
                rsi: 59.1,
                macdBullish: true,
                bbPosition: 'middle',
                atr: 67.8,
                momentum: 'strong',
                signal: 'BUY'
            },
            'tips music': {
                name: 'Tips Music Ltd',
                symbol: 'TIPS',
                price: 587.95,
                marketCap: 7515,
                volume: 180000,
                avgVolume: 95000,
                ema20: 565,
                ema50: 520,
                ema200: 485,
                rsi: 64.8,
                macdBullish: true,
                bbPosition: 'upper',
                atr: 32.4,
                momentum: 'strong',
                signal: 'BUY'
            }
        };

        // Pine Script Strategy Implementation
        function evaluateStrategy(stock) {
            const data = momentumStockDatabase[stock];
            if (!data) return null;

            // Universe Filter
            const universeOk = data.price >= 50 && data.price <= 10000 && data.volume >= 500000;

            // Trend Filter (EMA 20 > EMA 50 > EMA 200 and close > EMA 20)
            const trendUp = data.ema20 > data.ema50 && data.ema50 > data.ema200 && data.price > data.ema20;

            // Momentum Filter (RSI between 40-80 and MACD bullish)
            const momentumOk = data.rsi >= 40 && data.rsi <= 80 && data.macdBullish;

            // Volume Surge (1.5x average volume)
            const volumeSurge = data.volume > (data.avgVolume * 1.5);

            // Volatility Filter (above BB middle)
            const volatilityOk = data.bbPosition === 'upper' || data.bbPosition === 'middle';

            // Base Long Condition
            const baseLong = universeOk && trendUp && momentumOk && volatilityOk && volumeSurge;

            // Breakout Strategy
            const breakoutLong = universeOk && volumeSurge && data.rsi > 50 && data.rsi < 80;

            // Momentum Strategy
            const momentumLong = universeOk && data.price > data.ema20 && data.price > data.ema50 && data.price > data.ema200 && data.rsi > 60;

            return {
                universeOk,
                trendUp,
                momentumOk,
                volumeSurge,
                volatilityOk,
                baseLong,
                breakoutLong,
                momentumLong,
                finalSignal: baseLong || breakoutLong || momentumLong
            };
        }

        // Load Momentum Stocks
        function loadMomentumStocks() {
            const container = document.getElementById('momentumStocks');
            const topStocks = Object.keys(momentumStockDatabase).slice(0, 5);
            
            container.innerHTML = topStocks.map(stock => {
                const data = momentumStockDatabase[stock];
                const analysis = evaluateStrategy(stock);
                
                const cardClass = analysis.finalSignal ? (data.momentum === 'very_strong' ? 'strong-momentum' : 'buy-signal') : '';
                const badgeClass = analysis.finalSignal ? (data.momentum === 'very_strong' ? 'momentum-badge' : 'buy-badge') : '';
                const badgeText = analysis.finalSignal ? (data.momentum === 'very_strong' ? 'STRONG BUY' : 'BUY SIGNAL') : 'WAIT';
                
                const volumeRatio = (data.volume / data.avgVolume).toFixed(1);
                const rsiStatus = data.rsi > 70 ? 'bullish' : data.rsi > 50 ? 'neutral' : 'bearish';
                
                return `
                    <div class="stock-card ${cardClass}">
                        ${analysis.finalSignal ? `<div class="signal-badge ${badgeClass}">${badgeText}</div>` : ''}
                        <div class="stock-symbol">${data.symbol}</div>
                        <div class="stock-name">${data.name}</div>
                        
                        <div class="stock-metrics">
                            <div class="metric">
                                <div class="metric-label">Price</div>
                                <div class="metric-value">₹${data.price.toLocaleString()}</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">RSI</div>
                                <div class="metric-value ${rsiStatus}">${data.rsi}</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Volume Surge</div>
                                <div class="metric-value ${volumeRatio > 1.5 ? 'bullish' : 'neutral'}">${volumeRatio}x</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">Trend</div>
                                <div class="metric-value ${analysis.trendUp ? 'bullish' : 'bearish'}">${analysis.trendUp ? 'UPTREND' : 'DOWNTREND'}</div>
                            </div>
                        </div>

                        <div class="strategy-details">
                            <h4>MMM Strategy Analysis</h4>
                            <div class="conditions-met">
                                <span class="condition-tag ${analysis.universeOk ? 'met' : ''}">Universe ✓</span>
                                <span class="condition-tag ${analysis.trendUp ? 'met' : ''}">EMA Trend ✓</span>
                                <span class="condition-tag ${analysis.momentumOk ? 'met' : ''}">RSI Range ✓</span>
                                <span class="condition-tag ${analysis.volumeSurge ? 'met' : ''}">Volume Surge ✓</span>
                                <span class="condition-tag ${analysis.volatilityOk ? 'met' : ''}">Volatility ✓</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Update Market Time
        function updateMarketTime() {
            const now = new Date();
            const istTime = new Intl.DateTimeFormat('en-IN', {
                timeZone: 'Asia/Kolkata',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            }).format(now);
            
            document.getElementById('marketTime').textContent = istTime;
        }

        // Simulate live market updates
        function updateMarketData() {
            // Simulate small random changes in market indices
            const indices = ['nifty50', 'sensex', 'midcap150', 'smallcap250', 'vix', 'usdinr'];
            
            indices.forEach(index => {
                const element = document.getElementById(index);
                if (element) {
                    const currentValue = parseFloat(element.textContent.replace(/,/g, ''));
                    const change = (Math.random() - 0.5) * 0.02; // ±1% max change
                    const newValue = currentValue * (1 + change);
                    element.textContent = newValue.toLocaleString('en-IN', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    });
                }
            });
        }

        // Search functionality (reusing from previous code)
        function searchStock() {
            const stockName = document.getElementById('stockSearch').value.toLowerCase().trim();
            
            if (!stockName) {
                alert('Please enter a stock name');
                return;
            }
            
            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('reportContainer').style.display = 'none';
            
            // Simulate analysis
            setTimeout(() => {
                generateReport(stockName);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('reportContainer').style.display = 'block';
                document.getElementById('reportContainer').scrollIntoView({ behavior: 'smooth' });
            }, 2000);
        }

        function generateReport(stockName) {
            // Find stock data
            let stockData = null;
            for (const key in momentumStockDatabase) {
                if (stockName.includes(key) || key.includes(stockName)) {
                    stockData = momentumStockDatabase[key];
                    break;
                }
            }
            
            if (!stockData) {
                document.getElementById('reportContainer').innerHTML = `
                    <div style="padding: 40px; text-align: center; background: white;">
                        <h2 style="color: #dc3545;">⚠️ Stock Not Found</h2>
                        <p style="margin: 20px 0;">Try searching for: Man Infraconstruction, Reliance, Shilchar Tech, Websol Energy, Tips Music</p>
                    </div>
                `;
                return;
            }
            
            const analysis = evaluateStrategy(stockName);
            
            // Generate comprehensive report with Pine Script analysis
            const reportHTML = `
                <header style="background: linear-gradient(135deg, #2c5aa0, #1e4178); color: white; padding: 40px; text-align: center;">
                    <h1>${stockData.name}</h1>
                    <h2>Comprehensive Analysis with MMM Strategy</h2>
                    <p style="margin-top: 15px; opacity: 0.9;">MIDCAP MOMENTUM MASTER v6 Analysis</p>
                </header>

                <section class="section">
                    <h2>🎯 Pine Script Strategy Analysis</h2>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div>
                            <h3>Strategy Conditions</h3>
                            <table class="data-table">
                                <thead>
                                    <tr><th>Condition</th><th>Status</th><th>Value</th></tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Universe Filter</td>
                                        <td><span class="trend-${analysis.universeOk ? 'up' : 'down'}">${analysis.universeOk ? '✓' : '✗'}</span></td>
                                        <td>₹${stockData.price} | Vol: ${(stockData.volume/1000).toFixed(0)}K</td>
                                    </tr>
                                    <tr>
                                        <td>EMA Trend</td>
                                        <td><span class="trend-${analysis.trendUp ? 'up' : 'down'}">${analysis.trendUp ? '✓' : '✗'}</span></td>
                                        <td>20: ${stockData.ema20} | 50: ${stockData.ema50} | 200: ${stockData.ema200}</td>
                                    </tr>
                                    <tr>
                                        <td>RSI Momentum</td>
                                        <td><span class="trend-${analysis.momentumOk ? 'up' : 'down'}">${analysis.momentumOk ? '✓' : '✗'}</span></td>
                                        <td>RSI: ${stockData.rsi} | MACD: ${stockData.macdBullish ? 'Bullish' : 'Bearish'}</td>
                                    </tr>
                                    <tr>
                                        <td>Volume Surge</td>
                                        <td><span class="trend-${analysis.volumeSurge ? 'up' : 'down'}">${analysis.volumeSurge ? '✓' : '✗'}</span></td>
                                        <td>${(stockData.volume/stockData.avgVolume).toFixed(1)}x average volume</td>
                                    </tr>
                                    <tr>
                                        <td>Volatility</td>
                                        <td><span class="trend-${analysis.volatilityOk ? 'up' : 'down'}">${analysis.volatilityOk ? '✓' : '✗'}</span></td>
                                        <td>BB Position: ${stockData.bbPosition.toUpperCase()}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="background: ${analysis.finalSignal ? 'linear-gradient(135deg, #28a745, #20c997)' : 'linear-gradient(135deg, #ffc107, #fd7e14)'}; color: white; padding: 30px; border-radius: 15px;">
                                <h3>Pine Script Signal</h3>
                                <div style="font-size: 36px; font-weight: bold; margin: 20px 0;">
                                    ${analysis.finalSignal ? 'BUY' : 'WAIT'}
                                </div>
                                <p><strong>Strategy Type:</strong> ${analysis.breakoutLong ? 'Breakout' : analysis.momentumLong ? 'Momentum' : 'Base Long'}</p>
                                <p style="margin-top: 10px; font-size: 14px; opacity: 0.9;">
                                    Risk: 3% | Stop Loss: 2% | Target: 6% (3:1 R:R)
                                </p>
                            </div>
                            
                            <div style="margin-top: 20px; background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4>Position Sizing</h4>
                                <p><strong>Entry Price:</strong> ₹${stockData.price}</p>
                                <p><strong>Stop Loss:</strong> ₹${(stockData.price * 0.98).toFixed(2)}</p>
                                <p><strong>Target:</strong> ₹${(stockData.price * 1.06).toFixed(2)}</p>
                                <p><strong>Risk per Trade:</strong> 3% of portfolio</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="section">
                    <h2>📊 Technical Indicators</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4>RSI Analysis</h4>
                            <div style="font-size: 24px; font-weight: bold; margin: 10px 0; color: ${stockData.rsi > 70 ? '#dc3545' : stockData.rsi > 50 ? '#28a745' : '#ffc107'};">
                                ${stockData.rsi}
                            </div>
                            <p>${stockData.rsi > 70 ? 'Overbought Zone' : stockData.rsi > 50 ? 'Bullish Territory' : 'Oversold Territory'}</p>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4>Volume Analysis</h4>
                            <div style="font-size: 24px; font-weight: bold; margin: 10px 0; color: ${stockData.volume > stockData.avgVolume * 1.5 ? '#28a745' : '#ffc107'};">
                                ${(stockData.volume/stockData.avgVolume).toFixed(1)}x
                            </div>
                            <p>${stockData.volume > stockData.avgVolume * 1.5 ? 'Strong Volume Surge' : 'Normal Volume'}</p>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4>Trend Strength</h4>
                            <div style="font-size: 24px; font-weight: bold; margin: 10px 0; color: ${analysis.trendUp ? '#28a745' : '#dc3545'};">
                                ${analysis.trendUp ? 'STRONG' : 'WEAK'}
                            </div>
                            <p>EMA ${analysis.trendUp ? 'Uptrend' : 'Downtrend'} Configuration</p>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                            <h4>MACD Signal</h4>
                            <div style="font-size: 24px; font-weight: bold; margin: 10px 0; color: ${stockData.macdBullish ? '#28a745' : '#dc3545'};">
                                ${stockData.macdBullish ? 'BULLISH' : 'BEARISH'}
                            </div>
                            <p>MACD Line ${stockData.macdBullish ? 'Above' : 'Below'} Signal</p>
                        </div>
                    </div>
                </section>
            `;
            
            document.getElementById('reportContainer').innerHTML = reportHTML;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadMomentumStocks();
            updateMarketTime();
            
            // Update market time every second
            setInterval(updateMarketTime, 1000);
            
            // Update market data every 30 seconds (simulated)
            setInterval(updateMarketData, 30000);
        });

        // Enter key support
        document.getElementById('stockSearch').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchStock();
            }
        });
    </script>
</body>
</html>
